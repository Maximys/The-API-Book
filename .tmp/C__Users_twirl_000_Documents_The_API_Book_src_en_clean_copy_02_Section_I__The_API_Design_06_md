{"data":{"counter":13,"refCounter":0,"stat":{"words":21025,"characters":98720},"l10n":{"title":"The API","author":"Sergey Konstantinov","chapter":"Chapter","toc":"Table of Contents","description":"Designing APIs is a very special skill: API is a multiplier to both your opportunities and mistakes. This book is written to share the expertise and describe the best practices in designing and developing APIs. In Section I, we'll discuss the API architecture as a concept: how to build the hierarchy properly, from high-level planning down to final interfaces. Section II is dedicated to expanding existing APIs in a backwards-compatible manner. Finally, in Section III we will talk about the API as a product.","locale":"en_US","file":"API","aboutMe":{"title":"About the Author","content":["<p>Sergey Konstantinov has been working with APIs for more than a decade. He started his career as a software engineer in the Maps API division at Yandex and eventually became the head of the service, being responsible for both technical architecture and product management.</p>","<p>During this tenure, Sergey got a unique experience in building world-class APIs with a daily audience of tens of millions, planning roadmaps for such a service, and giving numerous public speeches. He also worked for a year and a half as a member of the W3C Technical Architecture Group.</p>","<p>After nine years in Maps, Sergey switched to technical-lead roles in other departments and companies, leading integration efforts and being responsible for the technical architecture of entire business units. Today, Sergey lives in Tallinn, Estonia, and works as a staff software engineer at Bolt.</p>"],"imageCredit":"Photo by <a href=\"http://linkedin.com/in/zloylos/\">Denis Hananein</a>"},"landingFile":"index.html","url":"https://twirl.github.io/The-API-Book/","favicon":"/img/favicon.png","sidePanel":{"shareTo":"Share","copyLink":"Link","shareParameters":{"url":"https://twirl.github.io/The-API-Book/","text":"The API by Sergey Konstantinov — a book about designing APIs, extending them and finding a proper place in the market","tags":"API,TheAPIBook","viaTwitter":"blogovodoved"},"services":[{"key":"facebook","link":"https://www.facebook.com/sharer.php?u=${url}"},{"key":"twitter","link":"https://twitter.com/intent/tweet?text=${text}&url=${url}&hashtags=${tags}&via=${viaTwitter}"},{"key":"linkedin","link":"https://www.linkedin.com/sharing/share-offsite/?url=${url}"},{"key":"reddit","link":"http://www.reddit.com/submit?url=${url}&title=${text}"}]},"imageCredit":"Image Credit","links":{"email":"yatwirl@gmail.com","emailString":"yatwirl@gmail.com","linkedinHref":"https://www.linkedin.com/in/twirl/","linkedinString":"linkedin.com/in/twirl","patreonHref":"https://www.patreon.com/yatwirl","patreonString":"patreon.com/yatwirl","patreonTag":"Patreon","githubHref":"https://github.com/twirl/The-API-Book","githubString":"github.com/twirl/The-API-Book","twitterHref":"https://twitter.com/blogovodoved","kindleHref":"https://www.amazon.com/gp/product/B09RHH44S5/ref=dbs_a_def_rwt_hsch_vapi_tkin_p1_i0","kindleTag":"buy Kindle version","mediumHref":"https://twirl.medium.com/","mediumTag":"Medium"},"sourceCodeAt":"Source code available at","frontPage":{"title":"The API","pageTitle":"Front Page","contents":["<p>The API-first development is one of the hottest technical topics nowadays, since many companies started to realize that API serves as a multiplicator to their opportunities—but it also amplifies the design mistakes as well.</p>","<p>This book is written to share the expertise and describe the best practices in designing and developing APIs. In Section I, we'll discuss the API architecture as a concept: how to build the hierarchy properly, from high-level planning down to final interfaces. Section II is dedicated to expanding existing APIs in a backwards-compatible manner. Finally, in Section III we will talk about the API as a product.</p>","<p class=\"text-align-left\">Illustrations &amp; inspiration by Maria Konstantinova &middot; <a href=\"https://www.instagram.com/art.mari.ka/\">art.mari.ka</a></p>","<img class=\"cc-by-nc-img\" alt=\"Creative Commons «Attribution-NonCommercial» Logo\" src=\"https://i.creativecommons.org/l/by-nc/4.0/88x31.png\"/>","<p class=\"cc-by-nc\">This book is distributed under the <a href=\"http://creativecommons.org/licenses/by-nc/4.0/\">Creative Commons Attribution-NonCommercial 4.0 International licence</a>.</p>"]},"landing":{"subTitle":"Free e-book","subscribeOn":"Subscribe for updates on","updates":["github"],"followOn":"Follow me on","follow":["linkedin","twitter","medium"],"supportThisWork":"Support this work on","support":["patreon","kindle"],"content":["<p>The API-first development is one of the hottest technical topics nowadays, since many companies started to realize that API serves as a multiplicator to their opportunities—but it also amplifies the design mistakes as well.</p>","<p>This book is written to share the expertise and describe the best practices in designing and developing APIs. In Section I, we'll discuss the API architecture as a concept: how to build the hierarchy properly, from high-level planning down to final interfaces. Section II is dedicated to expanding existing APIs in a backwards-compatible manner. Finally, in Section III we will talk about the API as a product.</p>","<p>Illustration &amp; inspiration: <a href=\"https://www.instagram.com/art.mari.ka/\">art.mari.ka</a>.</p>"],"download":"You might download ‘The API’ in","or":"or","readOnline":"read it online","license":"This book is distributed under the <a href=\"http://creativecommons.org/licenses/by-nc/4.0/\">Creative Commons Attribution-NonCommercial 4.0 International licence</a>.","footer":["<p>Книгу «API» можно <a href=\"index.ru.html\">читать по-русски</a>.</p>"]}},"base":"C:\\Users\\twirl_000\\Documents\\The-API-Book\\src","templates":{"pageBreak":"<div class=\"page-break\"></div>"},"anchor":"chapter-12","titleParts":["Annex to Section I. Generic API Example"],"localContext":null,"references":[],"title":"Chapter 12. Annex to Section I. Generic API Example"},"messages":[],"history":[],"cwd":"C:\\Users\\twirl_000\\Documents\\The-API-Book","value":"\n<p>Let's summarize the current state of our API study.</p>\n<h5><a href=\"#chapter-12-paragraph-1\" id=\"chapter-12-paragraph-1\" class=\"anchor\">1. Offer search</a></h5>\n<pre><code>POST /v1/offers/search\n{\n  // optional\n  \"recipes\": [\"lungo\", \"americano\"],\n  \"position\": &#x3C;geographical coordinates>,\n  \"sort_by\": [\n    { \"field\": \"distance\" }\n  ],\n  \"limit\": 10\n}\n→\n{\n  \"results\": [{\n    // Place data\n    \"place\": \n      { \"name\", \"location\" },\n    // Coffee machine properties\n    \"coffee-machine\": \n      { \"id\", \"brand\", \"type\" },\n    // Route data\n    \"route\": { \n      \"distance\", \n      \"duration\", \n      \"location_tip\" \n    },\n    \"offers\": [{\n      // Recipe data\n      \"recipe\": \n        { \"id\", \"name\", \"description\" },\n      // Recipe specific options\n      \"options\": \n        { \"volume\" },\n      // Offer metadata\n      \"offer\": \n        { \"id\", \"valid_until\" },\n      // Pricing\n      \"pricing\": { \n        \"currency_code\", \n        \"price\", \n        \"localized_price\" \n      },\n      \"estimated_waiting_time\"\n    }, …]\n  }, …],\n  \"cursor\"\n}\n</code></pre>\n<h5><a href=\"#chapter-12-paragraph-2\" id=\"chapter-12-paragraph-2\" class=\"anchor\">2. Working with recipes</a></h5>\n<pre><code>// Returns a list of recipes\n// Cursor parameter is optional\nGET /v1/recipes?cursor=&#x3C;cursor>\n→\n{ \"recipes\", \"cursor\" }\n</code></pre>\n<pre><code>// Returns the recipe by its id\nGET /v1/recipes/{id}\n→\n{ \n  \"recipe_id\", \n  \"name\", \n  \"description\" \n}\n</code></pre>\n<h5><a href=\"#chapter-12-paragraph-3\" id=\"chapter-12-paragraph-3\" class=\"anchor\">3. Working with orders</a></h5>\n<pre><code>// Creates an order\nPOST /v1/orders\n{\n  \"coffee_machine_id\",\n  \"currency_code\",\n  \"price\",\n  \"recipe\": \"lungo\",\n  // Optional\n  \"offer_id\",\n  // Optional\n  \"volume\": \"800ml\"\n}\n→\n{ \"order_id\" }\n</code></pre>\n<pre><code>// Returns the order by its id\nGET /v1/orders/{id}\n→\n{ \"order_id\", \"status\" }\n</code></pre>\n<pre><code>// Cancels the order\nPOST /v1/orders/{id}/cancel\n</code></pre>\n<h5><a href=\"#chapter-12-paragraph-4\" id=\"chapter-12-paragraph-4\" class=\"anchor\">4. Working with programs</a></h5>\n<pre><code>// Returns an identifier of the program\n// corresponding to specific recipe\n// on specific coffee-machine\nPOST /v1/program-matcher\n{ \"recipe\", \"coffee-machine\" }\n→\n{ \"program_id\" }\n</code></pre>\n<pre><code>// Return program description\n// by its id\nGET /v1/programs/{id}\n→\n{\n  \"program_id\",\n  \"api_type\",\n  \"commands\": [\n    {\n      \"sequence_id\",\n      \"type\": \"set_cup\",\n      \"parameters\"\n    },\n    …\n  ]\n}\n</code></pre>\n<h5><a href=\"#chapter-12-paragraph-5\" id=\"chapter-12-paragraph-5\" class=\"anchor\">5. Running programs</a></h5>\n<pre><code>// Runs the specified program\n// on the specified coffee-machine\n// with specific parameters\nPOST /v1/programs/{id}/run\n{\n  \"order_id\",\n  \"coffee_machine_id\",\n  \"parameters\": [\n    {\n      \"name\": \"volume\",\n      \"value\": \"800ml\"\n    }\n  ]\n}\n→\n{ \"program_run_id\" }\n</code></pre>\n<pre><code>// Stops program running\nPOST /v1/runs/{id}/cancel\n</code></pre>\n<h5><a href=\"#chapter-12-paragraph-6\" id=\"chapter-12-paragraph-6\" class=\"anchor\">6. Managing runtimes</a></h5>\n<pre><code>// Creates a new runtime\nPOST /v1/runtimes\n{ \n  \"coffee_machine_id\", \n  \"program_id\", \n  \"parameters\" \n}\n→\n{ \"runtime_id\", \"state\" }\n</code></pre>\n<pre><code>// Returns the state\n// of the specified runtime\nGET /v1/runtimes/{runtime_id}/state\n{\n  \"status\": \"ready_waiting\",\n  // Command being currently executed\n  // (optional)\n  \"command_sequence_id\",\n  \"resolution\": \"success\",\n  \"variables\"\n}\n</code></pre>\n<pre><code>// Terminates the runtime\nPOST /v1/runtimes/{id}/terminate\n</code></pre>"}